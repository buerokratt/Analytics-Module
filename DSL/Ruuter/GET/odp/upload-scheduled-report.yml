getJobDetails:
  call: http.post
  args:
    url: "[#ANALYTICS_RESQL]/get-scheduled-report"
    body:
      datasetId: ${incoming.params.datasetId}
  result: jobDetails

uploadImmediately:
  template: upload
  requestType: post
  body:
    metrics: ${jobDetails.response.metrics}
    start: ${jobDetails.response.startDate}
    end: ${jobDetails.response.endDate}
    period: ${jobDetails.response.period}
    datasetId: ${incoming.params.datasetId}
    dateTime: ${incoming.params.dateTime}
  result: uploadResult

return_result:
  return: "Dataset uploaded successfully"
  next: end

